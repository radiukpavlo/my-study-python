% % % % % % % % % % % % %
% % % % % % % %
% %
% % Style common to both Calculus and Linear Algebra textbooks
% %
% % % % % % % %
% % % % % % % % % % % % %







%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Colour common to both texts
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% %
% Links and urls colour
\definecolor{linkcolour}{HTML}{013030}

% Colour for grey square in page header
\definecolor{headersquarecolour}{HTML}{BDBDBD}

%Lyryx Brand Colours
\definecolor{lyryxcolour}{HTML}{000033}
\definecolor{lyryxlogoy}{HTML}{E2970A}

% %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% . . . End of Colours . . . 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Lyryx Logo font common to both texts
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Font used for Logo type 
\newcommand*{\logofont}{\robotocondensed\selectfont}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% . . . End of Lyryx Logo font . . . 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% The following commands changes the position of floats by overriding the Latex defaults.
% Changes the fraction of floats appearing at the top and bottom, and the fraction of the page that is text
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
\renewcommand\floatpagefraction{.9}
\renewcommand\topfraction{.9}
\renewcommand\bottomfraction{.9}
\renewcommand\textfraction{.1}
\setcounter{totalnumber}{50}
\setcounter{topnumber}{50}
\setcounter{bottomnumber}{50}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Headers
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Chapter Header
\titleformat{\chapter}[display]
{\color{chaptertitlecolour}\bf\Huge}
{\hspace*{0pt}\thechapter.~#1} %-70
{-20pt}
{\hspace*{0pt}{\color{chaptertitlecolour}\rule{\dimexpr\textwidth\relax}{2pt}}\Huge} %-110
\titleformat{name=\chapter,numberless}[display]
{\color{chaptertitlecolour}\bf\Huge}
{\hspace*{0pt}#1}
{-20pt}
{\hspace*{0pt}{\color{chaptertitlecolour}\rule{\dimexpr\textwidth\relax}{2pt}}\Huge}
\titlespacing*{\chapter}{0pt}{10pt}{10pt}

% Section Header
\titleformat{\section}[display]
{\bigskip\bigskip\hypersetup{linkcolor=sectiontitlecolour}\color{sectiontitlecolour}\bf\LARGE}
{\hspace*{0pt}\thesection~#1} 
{-15pt}
{\hspace*{0pt}{\color{sectiontitlecolour}\rule{\dimexpr\textwidth\relax}{2pt}}\LARGE}
\titleformat{name=\section,numberless}[display]
{\bigskip\bigskip\hypersetup{linkcolor=sectiontitlecolour}\color{sectiontitlecolour}\bf\LARGE}
{\hspace*{0pt}#1}
{-15pt}
{\hspace*{0pt}{\color{sectiontitlecolour}\rule{\dimexpr\textwidth\relax}{2pt}}\LARGE}
\titlespacing*{\section}{0pt}{0pt}{10pt}

% Subsection header
\titleformat{\subsection}[display]
{\color{subsectiontitlecolour}\bf\large}
{\hspace*{0pt}\thesubsection.~#1} 
{-10pt}
{\hspace*{0pt}{\color{subsectiontitlecolour}\rule{\dimexpr\textwidth\relax}{2pt}}\large}%{\hspace*{0pt}{\color{subsectiontitlecolour}\rule{.3\textwidth\relax}{0pt}}\large} 
\titleformat{name=\subsection,numberless}[display]
{\color{subsectiontitlecolour}\bf\large}
{\hspace*{0pt}#1}
{-10pt}
{\hspace*{0pt}{\color{subsectiontitlecolour}\rule{\dimexpr\textwidth\relax}{2pt}}\large}%{\hspace*{0pt}{\color{subsectiontitlecolour}\rule{.5\textwidth}{0pt}}\large}
\titlespacing*{\subsection}{0pt}{10pt}{10pt}

% Subsubsection header
\titleformat{\subsubsection}[display]
{\color{subsubsectiontitlecolour}\bf\normalsize}
{\hspace*{0pt}\thesubsubsection.~#1} 
{-10pt}
{\hspace*{0pt}{\color{subsubsectiontitlecolour}\rule{\dimexpr\textwidth\relax}{2pt}}\large}%{\hspace*{0pt}{\color{subsectiontitlecolour}\rule{.3\textwidth\relax}{0pt}}\large} 
\titleformat{name=\subsubsection,numberless}[display]
{\color{subsubsectiontitlecolour}\bf\normalsize}
{\hspace*{0pt}#1}
{-10pt}
{\hspace*{0pt}{\color{subsubsectiontitlecolour}\rule{\dimexpr\textwidth\relax}{2pt}}\large}%{\hspace*{0pt}{\color{subsectiontitlecolour}\rule{.5\textwidth}{0pt}}\large}
\titlespacing*{\subsubsection}{0pt}{10pt}{10pt}


% To allow numbering of subsubsections
\setcounter{secnumdepth}{3}

% To include subsubsections in the TOC
\setcounter{tocdepth}{3}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Fancy page header commands
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
\newcommand\graysquare{\textcolor{headersquarecolour}{\rule{1ex}{1ex}}} % gray square between page number and chapter/section name

\pagestyle{fancy}
\renewcommand{\chaptermark}[1]{\markboth{#1}{}}
\renewcommand{\sectionmark}[1]{\markright{\thesection.\ #1}}
\fancyhf{}
\fancyhead[RO]{\rightmark\hspace{0.5em}\graysquare\hspace{0.5em}\thepage}
\fancyhead[LE]{\thepage\hspace{0.5em}\graysquare\hspace{0.5em}\leftmark}
\renewcommand{\headrulewidth}{0pt}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Boxes on title page
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% For the main box containing School, Base Text, Sample information
\newtcolorbox{titlemainbox}{colback=titlemainboxcolour,colframe=titlemainboxcolour,before={\par\bigskip\pagebreak[0]\parindent=0pt},after={\par\bigskip},top=1em,bottom=1em}

% For the Lyryx marketing page paragraph header boxes
\newtcolorbox{lscshdrbox}{colback=lscshdrboxcolour,colframe=lscshdrboxcolour,top=0mm,bottom=0mm,width=19em}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Defines setup and colours for hyperlinks
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
\hypersetup{
	pdfborder=0 0 0,
	colorlinks=true,
	allcolors=linkcolour, % Default color
	linkcolor=linkcolour, % Chapter/Section links, figures, tables, etc
	urlcolor=linkcolour, % Exploration links
}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Exercises & Solutions
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%
% Counter for exercises
% This option will only restart numbering at the end of the chapter
%\newcounter{ex}[chapter]
%\renewcommand{\theex}{\thesection.\arabic{ex}}

% This option will restart numbering at the end of each section
\newcounter{ex}[section]
\renewcommand{\theex}{\thesection.\arabic{ex}}

% ex env
% can \def\myextitle{#1} if we want to save the title for use in the solution
\newenvironment{ex}{
	\par\medskip\noindent\refstepcounter{ex}\textbf{Exercise \theex}\hspace{0.25em}\itshape
}{
\par\medskip
}

% answers package will place solutions in an solout env
\newenvironment{solout}[1]{
	\par\medskip\noindent\textbf{#1}\par
}{
\par\medskip
}
% answers package uses this command to copy params from exercise environment to solout
\newcommand{\soloutparams}{{\theex}}

% exsolution env, where output is sent to exsolutions file and text placed in exsolout envs
\Newassociation{sol}{Answer}{solutions}
%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Redefining enumerate styles for only part of the book
% Changes all first level items in listed to (a),(b),(c),etc

\newenvironment{enumialphparenastyle}{
	\let\oldlabelenumi=\labelenumi
	\renewcommand{\labelenumi}{\textrm{(\alph{enumi})}}
}{
\let\labelenumi=\oldlabelenumi
}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Used for Lyryx with Open Text icons (4 of them) on back cover of text
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Font used in componentnode
\newcommand*{\cmpfont}{\robotocondensed\selectfont}

% Tikz node with \footnotesize text, center aligned, white font (Used in text under Lyryx icons on print-cover and back cover)
\tikzset{
	componentnode/.style={
		font=\scriptsize\cmpfont,
		align=center,
		white,
		execute at begin node=\setlength{\baselineskip}{1.25em} 	% increases space between lines of text
	}
}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Creates page on left side (used on back cover)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
\newcommand*\cleartoleftpage{%
	\clearpage
	\ifodd\value{page}\hbox{}\newpage\fi
}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% A hack to do something like the center environment, but without spaces around it
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
\newenvironment{center*}[0]{\bgroup \centering}
{
	
	\egroup
}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Special commands and shorthand commands
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% These commands may be used to update older Latex commands...? 
\def\xrefn#1{\ref{#1}} % References
\def\figrdef#1{\label{#1}} % Labelling

% Shorthand command for displaystyle -- shows mathematical symbols in their full size
\def\ds{\displaystyle}

% Shorthand command for the symbol for the Set of Real Numbers
\def\R{\mathbb{R}}

% Change appearance of numbered equations
\renewcommand{\theequation}{\arabic{chapter}.\arabic{equation}}

% Bold font for definitions
\def\dfont#1{{\bf{#1}}}

% Italicized font for emphasis
\def\ifont#1{{\it{{#1}}}}

%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
